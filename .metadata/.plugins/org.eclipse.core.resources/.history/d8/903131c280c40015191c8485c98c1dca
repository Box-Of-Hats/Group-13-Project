package group13Project.security;

import java.security.KeyPair;
import java.security.KeyPairGenerator;
import java.security.NoSuchAlgorithmException;
import java.security.PrivateKey;
import java.security.PublicKey;
import javax.crypto.Cipher;
public class Cryptography {
	private PublicKey publicKey;
	private PrivateKey privateKey;
	private final int minStrength = 512;
	private final int normStrength = 1024;
	
	public Cryptography() {
		try {
			
			//Create a RSA public a private key
			KeyPairGenerator key = KeyPairGenerator.getInstance("RSA");
			key.initialize(this.normStrength);
			
			//Assign key pair to pair
			KeyPair pair = key.genKeyPair();
			
			//Assign private key to class attribute
			this.privateKey = pair.getPrivate();
			//Assign public key to class attribute
			this.publicKey = pair.getPublic() ;
			
		} catch(NoSuchAlgorithmException e) {
			e.printStackTrace();
		}
	}
	public Cryptography(int strength) {
		try {
			
			//Create a RSA public a private key
			KeyPairGenerator key = KeyPairGenerator.getInstance("RSA");
			
			//
			if(strength > this.minStrength)
				key.initialize(strength);
			else
				key.initialize(this.normStrength);
			
			//Assign key pair to pair
			KeyPair pair = key.genKeyPair();
			
			//Assign private key to class attribute
			this.privateKey = pair.getPrivate();
			//Assign public key to class attribute
			this.publicKey = pair.getPublic() ;
			
		} catch(NoSuchAlgorithmException e) {
			e.printStackTrace();
		}
	}
	
	public Byte[] encrypt(String message) {
		Byte[] encMessage;
		
		try {
			//choose encryption method
			final Cipher cipher = Cipher.getInstance("RSA");
			cipher.init(Cipher.ENCRYPT_MODE, this.privateKey);
			
			encMessage = cipher.doFinal();
			
		} catch( Exception e) {
			e.printStackTrace();
		}
		
		return encMessage;
	}

}


